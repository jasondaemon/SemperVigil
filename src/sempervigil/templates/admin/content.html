{% extends "admin/base.html" %}
{% set nav_active = "content" %}
{% set nav_subactive = "content" %}
{% block content %}
  <section class="panel">
    <h2>Content Browser</h2>
    <form id="content-search-form" class="filters" data-watchlist-enabled="{{ 'true' if watchlist_enabled else 'false' }}">
      <input type="text" id="content-query" placeholder="Search title or summary">
      <select id="content-type">
        <option value="all">All</option>
        <option value="article">Articles</option>
        <option value="cve">CVEs</option>
      </select>
      <select id="content-source">
        <option value="">All sources</option>
        {% for source in sources %}
          <option value="{{ source.id }}">{{ source.name }}</option>
        {% endfor %}
      </select>
      <select id="content-has-summary">
        <option value="">Any summary</option>
        <option value="1">Has summary</option>
        <option value="0">No summary</option>
      </select>
      <select id="content-missing">
        <option value="">Missing field</option>
        <option value="content">Missing content</option>
        <option value="summary">Missing summary</option>
        <option value="description">Missing description (CVEs)</option>
      </select>
      <input type="date" id="content-after">
      <input type="date" id="content-before">
      <select id="content-page-size">
        <option value="25">25</option>
        <option value="50" selected>50</option>
        <option value="100">100</option>
      </select>
      <button class="btn" type="submit">Search</button>
    </form>
    <details class="filters-advanced">
      <summary>Advanced filters</summary>
      <div class="filters">
        <label class="inline-check">
          <input type="checkbox" id="content-content-error">
          Content error
        </label>
        <label class="inline-check">
          <input type="checkbox" id="content-summary-error">
          Summary error
        </label>
        <select id="content-needs">
          <option value="">Pipeline state</option>
          <option value="fetch">Needs fetch</option>
          <option value="summarize">Needs summarize</option>
          <option value="publish">Ready to publish</option>
          <option value="attention">Needs attention</option>
        </select>
        <input type="text" id="content-tags" placeholder="Tags (comma)">
        <select id="content-severity">
          <option value="">Any severity</option>
          <option value="CRITICAL">CRITICAL</option>
          <option value="HIGH">HIGH</option>
          <option value="MEDIUM">MEDIUM</option>
          <option value="LOW">LOW</option>
        </select>
        <input type="number" step="0.1" id="content-min-cvss" placeholder="Min CVSS">
        {% if watchlist_enabled %}
        <label class="inline-check">
          <input type="checkbox" id="content-watchlist-only">
          Watchlist hits only
        </label>
        {% endif %}
      </div>
    </details>
    <p class="error" id="content-error" style="display:none;"></p>
    <div class="tag-panel">
      <div class="tag-panel-header">Tags</div>
      <div id="content-tag-list" class="tag-list"></div>
      <div class="tag-panel-selected">
        <div class="tag-panel-header">Selected tags</div>
        <div id="content-selected-tags" class="tag-chips"></div>
      </div>
    </div>
  </section>

  <section class="panel">
    <table id="content-table" class="table-compact">
      <thead>
        <tr>
          <th>Type</th>
          <th>ID</th>
          <th>Date</th>
          <th>Title / Summary</th>
          <th>Source</th>
          {% if watchlist_enabled %}
          <th>Watchlist</th>
          {% endif %}
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="pager" id="content-pager"></div>
  </section>
{% endblock %}
