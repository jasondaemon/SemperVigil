{% set nav_active = "content" %}
{% set nav_subactive = "events" %}
{% extends "admin/base.html" %}

{% block content %}
<section class="page">
  <div class="page-header">
    <h1>Events</h1>
    <div class="actions">
      <button class="btn secondary" id="events-derive">Derive Events</button>
      <button class="btn secondary" id="events-normalize">Normalize CVE Keys</button>
      <button class="btn secondary" id="events-rebuild">Rebuild Events</button>
      <button class="btn danger" id="events-purge">Purge Weak Events</button>
    </div>
  </div>
  <form class="filters" id="events-filters">
    <input type="text" id="events-query" placeholder="Search title/summary">
    <select id="events-kind">
      <option value="">All kinds</option>
      <option value="cve_cluster">CVE cluster</option>
      <option value="product_cluster">Product cluster</option>
      <option value="manual">Manual</option>
    </select>
    <select id="events-severity">
      <option value="">All severities</option>
      <option value="CRITICAL">Critical</option>
      <option value="HIGH">High</option>
      <option value="MEDIUM">Medium</option>
      <option value="LOW">Low</option>
      <option value="UNKNOWN">Unknown</option>
    </select>
    <select id="events-status">
      <option value="">All status</option>
      <option value="open">Open</option>
      <option value="closed">Closed</option>
    </select>
    <label class="checkbox"><input type="checkbox" id="events-include-legacy"> Include legacy</label>
    <input type="date" id="events-after">
    <input type="date" id="events-before">
    <button class="btn" type="submit">Apply</button>
  </form>
  <div class="panel inline">
    <div class="filters inline">
      <label class="checkbox"><input type="checkbox" id="events-purge-dry" checked> Dry run</label>
      <label>Mode
        <select id="events-purge-mode">
          <option value="suppress" selected>Suppress</option>
          <option value="delete">Delete</option>
        </select>
      </label>
      <label>Min articles
        <input type="number" id="events-purge-min-articles" value="1" min="0">
      </label>
      <label>Older than days
        <input type="number" id="events-purge-older" value="30" min="0">
      </label>
      <label class="checkbox"><input type="checkbox" id="events-purge-cve-only" checked> CVE clusters only</label>
      <label class="checkbox"><input type="checkbox" id="events-purge-empty-only" checked> Only empty CVE clusters</label>
    </div>
  </div>
  <div id="events-error" class="error-banner" style="display:none;"></div>
  <table class="table" id="events-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Title</th>
        <th>Kind</th>
        <th>Severity</th>
        <th>Status</th>
        <th>Last Seen</th>
        <th>Articles</th>
        <th>Source</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div id="events-pager" class="pager"></div>
</section>
{% endblock %}
